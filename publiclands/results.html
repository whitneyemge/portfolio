<!DOCTYPE HTML>
<!--
	Minimaxing by HTML5 UP
	html5up.net | @ajlkn
	Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->

<!-- CREDIT:
https://github.com/Leaflet/Leaflet.draw
http://132.72.155.230:3838/js/collaborative-mapping.html
http://duspviz.mit.edu/web-map-workshop/cartodb-data-collection/#
https://github.com/zostera/leaflet-legend -->

<html>
	<head>
		<title>Public Land Use Preferences</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
		<link rel="stylesheet" href="assets/css/main.css" />

		<!-- leaflet -->
		<link rel="stylesheet" href="https://unpkg.com/leaflet@1.6.0/dist/leaflet.css" integrity="sha512-xwE/Az9zrjBIphAcBb3F6JVqxf46+CDLwfLMHloNu6KEQCAWi6HcDUbeOfBIptF7tcCzusKFjFw2yuvEpDL9wQ==" crossorigin=""/>
		<script src="https://unpkg.com/leaflet@1.6.0/dist/leaflet.js" integrity="sha512-gZwIG9x3wUXg2hdXF6+rVkLF/0Vi9U8D2Ntg4Ga5I5BZpVkVxlJWbSQtXPSiUTtC0TjtGOmxa1AJPuV0CPthew==" crossorigin=""></script>

		<!-- leaflet legend -->
		<link rel="stylesheet" href="../leaflet/leaflet-legend.css" />
	  <script src="../leaflet/leaflet-legend.js"></script>

	</head>

	<body>
		<div id="page-wrapper">

			<!-- Header -->
				<div id="header-wrapper">
					<div class="container">
						<div class="row">
							<div class="col-12">

								<header id="header">
									<h1>Land Use Preference Mapping</h1>
									<nav id="nav">
									</nav>
								</header>

							</div>
						</div>
					</div>
				</div>

			<!-- Main -->

			<div id="main">
				<div class="container">
					<div class="row main-row">
						<div class="col-12">

							<section>
								<h2>Public Comments</h2>
								<p>The map below shows public comments on land use preferences in Colville National Forest in Washington State. Click on a polygon to see what people are saying!</p>
							</section>

									<!-- add map div -->
									<div id='map' style='height: 75vh; z-index: 1;'></div>

										<script>

										// Create Leaflet map
										var map = L.map('map').setView([48.588, -117.870], 9);
	                    L.tileLayer('https://api.mapbox.com/styles/v1/emgew/cka5l6m1s17cr1imz0gwap4ey/tiles/256/{z}/{x}/{y}@2x?access_token=pk.eyJ1IjoiZW1nZXciLCJhIjoiY2sybzlheDB4MDJrdDNwbXp1OXVmN3dseCJ9.ukmQwSpvGDqj0hChY4ZUyQ', {
	                        attribution: 'Map data &copy; <a href="https://www.openstreetmap.org/">OpenStreetMap</a> contributors, <a href="https://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, Imagery Â© <a href="https://www.mapbox.com/">Mapbox</a>',
											}).addTo(map);

											// Add legend
											L.control.legend({
											    items: [
											        {color: '#004097', label: 'Recreation'},
											        {color: '#149700', label: 'Timber Harvest'},
															{color: '#ca0094', label: 'Mining'},
															{color: '#ff7000', label: 'Grazing Livestock'},
															{color: '#ffe100', label: 'Tourism'},
															{color: '#400097', label: 'Conservation'}
											    ],
											    collapsed: false,
													buttonHtml: 'LEGEND'
											}).addTo(map);

										// Add feature group for drawn items and saved items
										//var cartoData = L.layerGroup().addTo(map);

										var url = "https://whitneyemge.carto.com/api/v2/sql?format=GeoJSON&q=";
										var sqlQuery = "SELECT the_geom, use_type, use_value_1, use_value_2, use_value_3, use_comments FROM land_preferences";

										fetch(url + sqlQuery)
										    .then(function(response) {
										        return response.json();
										    })
												.then(function(data) {
										        L.geoJSON(data, {
															style: function(feature, layer) {
																if (data.use_type == 'Recreation') {
																	return {
																		fillColor: '#004097',
																		color: '#004097',
																		fillOpacity: 0.5
																	};
																} else if (data.use_type == 'No Recreation') {
																	return {
																		fillColor: '#004097',
																		color: '#ff0000',
																		dashArray: '3,1',
																		fillOpacity: 0.5
																	};
																} else if (data.use_type == 'Timber Harvest') {
																	return {
																		fillColor: '#149700',
																		color: '#149700',
																		fillOpacity: 0.5
																	};
																} else if (data.use_type == 'No Timber Harvest') {
																	return {
																		fillColor: '#149700',
																		color: '#ff0000',
																		dashArray: '3,1',
																		fillOpacity: 0.5
																	};
																} else if (data.use_type == 'Mining') {
																	return {
																		fillColor: '#ca0094',
																		color: '#ca0094',
																		fillOpacity: 0.5
																	};
																} else if (data.use_type == 'No Mining') {
																	return {
																		fillColor: '#ca0094',
																		color: '#ff0000',
																		dashArray: '3,1',
																		fillOpacity: 0.5
																	};
																} else if (data.use_type == 'Grazing Livestock') {
																	return {
																		fillColor: '#ff7000',
																		color: '#ff7000',
																		fillOpacity: 0.5
																	};
																} else if (data.use_type == 'No Grazing Livestock') {
																	return {
																		fillColor: '#ff7000',
																		color: '#ff0000',
																		dashArray: '3,1',
																		fillOpacity: 0.5
																	};
																} else if (data.use_type == 'Tourism') {
																	return {
																		fillColor: '#ffe100',
																		color: '#ffe100',
																		fillOpacity: 0.5
																	};
																} else if (data.use_type == 'No Tourism') {
																	return {
																		fillColor: '#ffe100',
																		color: '#ff0000',
																		dashArray: '3,1',
																		fillOpacity: 0.5
																	};
																} else if (data.use_type == 'Conservation') {
																	return {
																		fillColor: '#400097',
																		color: '#400097',
																		fillOpacity: 0.5
																	};
																} else if (data.use_type == 'No Conservation') {
																	return {
																		fillColor: '#400097',
																		color: '#ff0000',
																		dashArray: '3,1',
																		fillOpacity: 0.5
																	};
																}
															},
										            onEachFeature: function(feature, layer) {
										                layer.bindPopup(
																			"<br>Use Type: " + feature.properties.use_type +
																			"<br>Value 1: " + feature.properties.use_value_1 +
																			"<br>Value 2: " + feature.properties.use_value_2 +
																			"<br>Value 3: " + feature.properties.use_value_3 +
																			"<br>Comments: " + feature.properties.use_comments
																		);
										            }
										        }).addTo(map);
										    });

											// Transfer submitted drawing to the CARTO layer
							        // var newData = layer.toGeoJSON();
							        // newData.properties.useType = uType;
							        // newData.properties.useValue1 = uValue1;
											// newData.properties.useValue2 = uValue2;
											// newData.properties.useValue3 = uValue3;
											// newData.properties.useComments = uComments;
							        // L.geoJSON(newData, {
											// 	style: function(feature) {
											// 		if (newData.properties.useType == 'Recreation') {
											// 			return {
											// 				fillColor: '#004097',
											// 				color: '#004097',
											// 				fillOpacity: 0.5
											// 			};
											// 		} else if (newData.properties.useType == 'No Recreation') {
											// 			return {
											// 				fillColor: '#004097',
											// 				color: '#ff0000',
											// 				dashArray: '3,1',
											// 				fillOpacity: 0.5
											// 			};
											// 		} else if (newData.properties.useType == 'Timber Harvest') {
											// 			return {
											// 				fillColor: '#149700',
											// 				color: '#149700',
											// 				fillOpacity: 0.5
											// 			};
											// 		} else if (newData.properties.useType == 'No Timber Harvest') {
											// 			return {
											// 				fillColor: '#149700',
											// 				color: '#ff0000',
											// 				dashArray: '3,1',
											// 				fillOpacity: 0.5
											// 			};
											// 		} else if (newData.properties.useType == 'Mining') {
											// 			return {
											// 				fillColor: '#ca0094',
											// 				color: '#ca0094',
											// 				fillOpacity: 0.5
											// 			};
											// 		} else if (newData.properties.useType == 'No Mining') {
											// 			return {
											// 				fillColor: '#ca0094',
											// 				color: '#ff0000',
											// 				dashArray: '3,1',
											// 				fillOpacity: 0.5
											// 			};
											// 		} else if (newData.properties.useType == 'Grazing Livestock') {
											// 			return {
											// 				fillColor: '#ff7000',
											// 				color: '#ff7000',
											// 				fillOpacity: 0.5
											// 			};
											// 		} else if (newData.properties.useType == 'No Grazing Livestock') {
											// 			return {
											// 				fillColor: '#ff7000',
											// 				color: '#ff0000',
											// 				dashArray: '3,1',
											// 				fillOpacity: 0.5
											// 			};
											// 		} else if (newData.properties.useType == 'Tourism') {
											// 			return {
											// 				fillColor: '#ffe100',
											// 				color: '#ffe100',
											// 				fillOpacity: 0.5
											// 			};
											// 		} else if (newData.properties.useType == 'No Tourism') {
											// 			return {
											// 				fillColor: '#ffe100',
											// 				color: '#ff0000',
											// 				dashArray: '3,1',
											// 				fillOpacity: 0.5
											// 			};
											// 		} else if (newData.properties.useType == 'Conservation') {
											// 			return {
											// 				fillColor: '#400097',
											// 				color: '#400097',
											// 				fillOpacity: 0.5
											// 			};
											// 		} else if (newData.properties.useType == 'No Conservation') {
											// 			return {
											// 				fillColor: '#400097',
											// 				color: '#ff0000',
											// 				dashArray: '3,1',
											// 				fillOpacity: 0.5
											// 			};
											// 		}
											// 	},
											// 	onEachFeature: addPopup
											// }).addTo(cartoData);

									</script>
								</section>
							</div>

							<!-- Direct user to homepage when finished -->
							<p>
							<a href="welcome.html" class="button">Finished</a>
							</p>

							</div>
						</div>
					</div>
				</div>

			<!-- Footer -->
				<div id="footer-wrapper">
					<div class="container">
						<div class="row">
							<div class="col-8 col-12-medium">

								<section>
									<h2>Data Sources</h2>
									<div>
										<div class="row">
											<div class="col-3 col-6-medium col-12-small">
												<ul class="link-list">
													<li><a href="https://data.fs.usda.gov/geodata/webapps/EDW_DataExtract/" target="_blank">USDA Forest Service</a></li>
													<li><a href="http://geo.wa.gov/datasets/wa-rco::wa-rco-trails-2017" target="_blank">WA State Recreation and Conservation Office</a></li>
												</ul>
											</div>

										</div>
									</div>
								</section>

							</div>

						</div>
						<div class="row">
							<div class="col-12">

								<div id="copyright">
									&copy; Untitled. All rights reserved. | Design: <a href="http://html5up.net">HTML5 UP</a>
								</div>

							</div>
						</div>
					</div>
				</div>
			</div>

		<!-- Scripts -->
			<script src="assets/js/jquery.min.js"></script>
			<script src="assets/js/browser.min.js"></script>
			<script src="assets/js/breakpoints.min.js"></script>
			<script src="assets/js/util.js"></script>
			<script src="assets/js/main.js"></script>

		<!-- Bootstrap Scripts -->
			<script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
			<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
			<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>


	</body>
</html>
