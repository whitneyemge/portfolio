<!DOCTYPE HTML>
<!--
	Minimaxing by HTML5 UP
	html5up.net | @ajlkn
	Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html>
	<head>
		<title>Public Land Use Preferences</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
		<link rel="stylesheet" href="assets/css/main.css" />

		<!-- mapbox libraries -->
		<script src='https://api.mapbox.com/mapbox-gl-js/v1.10.0/mapbox-gl.js'></script>
		<link href='https://api.mapbox.com/mapbox-gl-js/v1.10.0/mapbox-gl.css' rel='stylesheet' />

		<!-- mapbox drawing libraries -->
		<script src='https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-draw/v1.0.0/mapbox-gl-draw.js'></script>
		<link rel='stylesheet' href='https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-draw/v1.0.0/mapbox-gl-draw.css' type='text/css'/>
	</head>

	<body>
		<div id="page-wrapper">

			<!-- Header -->
				<div id="header-wrapper">
					<div class="container">
						<div class="row">
							<div class="col-12">

								<header id="header">
									<h1>Land Use Preference Mapping</h1>
									<nav id="nav">
										<!-- <a href="index.html">Homepage</a>
										<a href="twocolumn1.html" class="current-page-item">Two Column #1</a>
										<a href="twocolumn2.html">Two Column #2</a>
										<a href="onecolumn.html">One Column</a>
										<a href="threecolumn.html">Three Column</a> -->
									</nav>
								</header>

							</div>
						</div>
					</div>
				</div>

			<!-- Main -->

			<div id="main">
				<div class="container">
					<div class="row main-row">
						<div class="col-12">

							<section>
								<h2>Instructions</h2>
								<p>The map below shows the Colville National Forest in Washington State. Click on either the line or polygon icons and draw shapes on the map to represent places where you prefer certain land use types. Once you draw a feature, click either the recreation, agriculture, or forestry button above the map to indicate which type of land use the polygon or line represents.</p>
							</section>

								<section>
									<h2>Map</h2>

									<!-- land use type buttons -->
									<button class="small" id="pink-color" onclick="changeColor('pink')">Recreation</button>
									<button class="small" id="orange-color" onclick="changeColor('orange')">Agriculture</button>
									<button class="small" id="green-color" onclick="changeColor('green')">Forestry</button>

									<!-- add map div -->
									<div id='vgimap' style='height: 75vh;'></div>

									<!-- begin script -->
										<script>

										// mapbox access token
										mapboxgl.accessToken = 'pk.eyJ1IjoiZW1nZXciLCJhIjoiY2thN25hdGw1MDV0ajJxb2o4bjY3bmkzeSJ9.WdNbq8KLGQXG-XWkdVqhnQ';

										require('mapbox-gl-draw-free-mode');

										// add map to page
										var map = new mapboxgl.Map({
										  container: 'vgimap',
										  style: 'mapbox://styles/emgew/cka5l6m1s17cr1imz0gwap4ey',
										  center: [-117.870, 48.588],
										  zoom: 8
										});

										// add fullscreen and navigation options
										map.addControl(new mapboxgl.FullscreenControl());
										map.addControl(new mapboxgl.NavigationControl());

										//Thanks to https://bl.ocks.org/dnseminara/0790e53cef9867e848e716937727ab18 for styling

										//Add draw controls and shape design specs
									var draw = new MapboxDraw({
										userProperties: true,
										controls: {
												'combine_features': true,
												'uncombine_features': true,
												'polygon': true,
												'trash': true,
												'point': false,
												'line': false,
												'circle': true,
										},
										styles: [
												{
														'id': 'gl-draw-polygon-fill-inactive',
														'type': 'fill',
														'filter': ['all', ['==', 'active', 'false'],
																['==', '$type', 'Polygon'],
																['!=', 'mode', 'static']
														],
														'paint': {
																'fill-color': '#3bb2d0',
																'fill-outline-color': '#3bb2d0',
																'fill-opacity': 0.1
														}
												},
												{
														'id': 'gl-draw-polygon-fill-active',
														'type': 'fill',
														'filter': ['all', ['==', 'active', 'true'],
																['==', '$type', 'Polygon']
														],
														'paint': {
																'fill-color': '#fbb03b',
																'fill-outline-color': '#fbb03b',
																'fill-opacity': 0.1
														}
												},
												{
														'id': 'gl-draw-polygon-midpoint',
														'type': 'circle',
														'filter': ['all', ['==', '$type', 'Point'],
																['==', 'meta', 'midpoint']
														],
														'paint': {
																'circle-radius': 3,
																'circle-color': '#fbb03b'
														}
												},
												{
														'id': 'gl-draw-polygon-stroke-inactive',
														'type': 'line',
														'filter': ['all', ['==', 'active', 'false'],
																['==', '$type', 'Polygon'],
																['!=', 'mode', 'static']
														],
														'layout': {
																'line-cap': 'round',
																'line-join': 'round'
														},
														'paint': {
																'line-color': '#3bb2d0',
																'line-width': 2
														}
												},
												{
														'id': 'gl-draw-polygon-stroke-active',
														'type': 'line',
														'filter': ['all', ['==', 'active', 'true'],
																['==', '$type', 'Polygon']
														],
														'layout': {
																'line-cap': 'round',
																'line-join': 'round'
														},
														'paint': {
																'line-color': '#fbb03b',
																'line-dasharray': [0.2, 2],
																'line-width': 2
														}
												},
												{
														'id': 'gl-draw-line-inactive',
														'type': 'line',
														'filter': ['all', ['==', 'active', 'false'],
																['==', '$type', 'LineString'],
																['!=', 'mode', 'static']
														],
														'layout': {
																'line-cap': 'round',
																'line-join': 'round'
														},
														'paint': {
																'line-color': '#3bb2d0',
																'line-width': 2
														}
												},
												{
														'id': 'gl-draw-line-active',
														'type': 'line',
														'filter': ['all', ['==', '$type', 'LineString'],
																['==', 'active', 'true']
														],
														'layout': {
																'line-cap': 'round',
																'line-join': 'round'
														},
														'paint': {
																'line-color': '#fbb03b',
																'line-dasharray': [0.2, 2],
																'line-width': 2
														}
												},
												{
														'id': 'gl-draw-polygon-and-line-vertex-stroke-inactive',
														'type': 'circle',
														'filter': ['all', ['==', 'meta', 'vertex'],
																['==', '$type', 'Point'],
																['!=', 'mode', 'static']
														],
														'paint': {
																'circle-radius': 5,
																'circle-color': '#fff'
														}
												},
												{
														'id': 'gl-draw-polygon-and-line-vertex-inactive',
														'type': 'circle',
														'filter': ['all', ['==', 'meta', 'vertex'],
																['==', '$type', 'Point'],
																['!=', 'mode', 'static']
														],
														'paint': {
																'circle-radius': 3,
																'circle-color': '#fbb03b'
														}
												},
												{
														'id': 'gl-draw-point-point-stroke-inactive',
														'type': 'circle',
														'filter': ['all', ['==', 'active', 'false'],
																['==', '$type', 'Point'],
																['==', 'meta', 'feature'],
																['!=', 'mode', 'static']
														],
														'paint': {
																'circle-radius': 5,
																'circle-opacity': 1,
																'circle-color': '#fff'
														}
												},
												{
														'id': 'gl-draw-point-inactive',
														'type': 'circle',
														'filter': ['all', ['==', 'active', 'false'],
																['==', '$type', 'Point'],
																['==', 'meta', 'feature'],
																['!=', 'mode', 'static']
														],
														'paint': {
																'circle-radius': 3,
																'circle-color': '#3bb2d0'
														}
												},
												{
														'id': 'gl-draw-point-stroke-active',
														'type': 'circle',
														'filter': ['all', ['==', '$type', 'Point'],
																['==', 'active', 'true'],
																['!=', 'meta', 'midpoint']
														],
														'paint': {
																'circle-radius': 7,
																'circle-color': '#fff'
														}
												},
												{
														'id': 'gl-draw-point-active',
														'type': 'circle',
														'filter': ['all', ['==', '$type', 'Point'],
																['!=', 'meta', 'midpoint'],
																['==', 'active', 'true']
														],
														'paint': {
																'circle-radius': 5,
																'circle-color': '#fbb03b'
														}
												},
												{
														'id': 'gl-draw-polygon-fill-static',
														'type': 'fill',
														'filter': ['all', ['==', 'mode', 'static'],
																['==', '$type', 'Polygon']
														],
														'paint': {
																'fill-color': '#404040',
																'fill-outline-color': '#404040',
																'fill-opacity': 0.1
														}
												},
												{
														'id': 'gl-draw-polygon-stroke-static',
														'type': 'line',
														'filter': ['all', ['==', 'mode', 'static'],
																['==', '$type', 'Polygon']
														],
														'layout': {
																'line-cap': 'round',
																'line-join': 'round'
														},
														'paint': {
																'line-color': '#404040',
																'line-width': 2
														}
												},
												{
														'id': 'gl-draw-line-static',
														'type': 'line',
														'filter': ['all', ['==', 'mode', 'static'],
																['==', '$type', 'LineString']
														],
														'layout': {
																'line-cap': 'round',
																'line-join': 'round'
														},
														'paint': {
																'line-color': '#404040',
																'line-width': 2
														}
												},
												{
														'id': 'gl-draw-point-static',
														'type': 'circle',
														'filter': ['all', ['==', 'mode', 'static'],
																['==', '$type', 'Point']
														],
														'paint': {
																'circle-radius': 5,
																'circle-color': '#404040'
														}
												},
												{
														'id': 'gl-draw-polygon-color-picker',
														'type': 'fill',
														'filter': ['all', ['==', '$type', 'Polygon'],
																['has', 'user_portColor']
														],
														'paint': {
																'fill-color': ['get', 'user_portColor'],
																'fill-outline-color': ['get', 'user_portColor'],
																'fill-opacity': 0.5
														}
												},
												{
														'id': 'gl-draw-line-color-picker',
														'type': 'line',
														'filter': ['all', ['==', '$type', 'LineString'],
																['has', 'user_portColor']
														],
														'paint': {
																'line-color': ['get', 'user_portColor'],
																'line-width': 2
														}
												},
												{
														'id': 'gl-draw-point-color-picker',
														'type': 'circle',
														'filter': ['all', ['==', '$type', 'Point'],
																['has', 'user_portColor']
														],
														'paint': {
																'circle-radius': 3,
																'circle-color': ['get', 'user_portColor']
														}
												},

										]
								})

									// add draw variables to map
									map.addControl(draw, 'top-left');

									// change shape colors
									    function changeColor(color) {
									        if (drawFeatureID !== '' && typeof draw === 'object') {
									            if (color === 'pink') {
									                draw.setFeatureProperty(drawFeatureID, 'portColor', '#c70d3a');
									            } else if (color === 'orange') {
									                draw.setFeatureProperty(drawFeatureID, 'portColor', '#ed5107');
									            } else if (color === 'green') {
									                draw.setFeatureProperty(drawFeatureID, 'portColor', '#02383c');
									            }

									            var feat = draw.get(drawFeatureID);
									            draw.add(feat)
									        }
									    }

									    // callback for draw.update and draw.selectionchange
									    var setDrawFeature = function(e) {
									        if (e.features.length && e.features[0].type === 'Feature') {
									            var feat = e.features[0];
									            drawFeatureID = feat.id;
									        }
									    }

									    // event handlers for draw tools
									    map.on('draw.create', function() {
									        newDrawFeature = true;
									    });

									    map.on('draw.update', setDrawFeature);

									    map.on('draw.selectionchange', setDrawFeature);

									    map.on('click', function(e) {
									        if (!newDrawFeature) {
									            var drawFeatureAtPoint = draw.getFeatureIdsAt(e.point);

									            //if another drawFeature is not found - reset drawFeatureID
									            drawFeatureID = drawFeatureAtPoint.length ? drawFeatureAtPoint[0] : '';
									        }

									        newDrawFeature = false;

									    });

									// add listeners
									map.on('draw.create', updateArea);
									map.on('draw.delete', updateArea);
									map.on('draw.update', updateArea);

									// this function is called when a draw event is triggered (create, delete, update)
									function updateArea(e) {
											var data = draw.getAll();
											console.log(data);
									}

									</script>
								</section>
							</div>

							<p>
							<a href="#" class="button">Submit</a>
							</p>

								<!-- <section>
									<h2>How about some links?</h2>
									<div>
										<div class="row">
											<div class="col-6 col-12-small">
												<ul class="link-list">
													<li><a href="#">Sed neque nisi consequat</a></li>
													<li><a href="#">Dapibus sed mattis blandit</a></li>
													<li><a href="#">Quis accumsan lorem</a></li>
													<li><a href="#">Suspendisse varius ipsum</a></li>
													<li><a href="#">Eget et amet consequat</a></li>
												</ul>
											</div>
											<div class="col-6 col-12-small">
												<ul class="link-list">
													<li><a href="#">Quis accumsan lorem</a></li>
													<li><a href="#">Sed neque nisi consequat</a></li>
													<li><a href="#">Eget et amet consequat</a></li>
													<li><a href="#">Dapibus sed mattis blandit</a></li>
													<li><a href="#">Vitae magna sed dolore</a></li>
												</ul>
											</div>
										</div>
									</div>
								</section> -->

							</div>
						</div>
					</div>
				</div>

			<!-- Footer -->
				<div id="footer-wrapper">
					<div class="container">
						<div class="row">
							<div class="col-8 col-12-medium">

								<section>
									<h2>Data Sources</h2>
									<div>
										<div class="row">
											<div class="col-3 col-6-medium col-12-small">
												<ul class="link-list">
													<li><a href="https://data.fs.usda.gov/geodata/webapps/EDW_DataExtract/" target="_blank">USDA Forest Service</a></li>
													<li><a href="http://geo.wa.gov/datasets/wa-rco::wa-rco-trails-2017" target="_blank">WA State Recreation and Conservation Office</a></li>
												</ul>
											</div>

										</div>
									</div>
								</section>

							</div>
							<!-- <div class="col-4 col-12-medium">

								<section>
									<h2>About</h2>
									<p>Information pending</p>
									<footer class="controls">
										<a href="#" class="button">Button</a>
									</footer>
								</section>

							</div> -->
						</div>
						<div class="row">
							<div class="col-12">

								<div id="copyright">
									&copy; Untitled. All rights reserved. | Design: <a href="http://html5up.net">HTML5 UP</a>
								</div>

							</div>
						</div>
					</div>
				</div>

		</div>

		<!-- Scripts -->
			<script src="assets/js/jquery.min.js"></script>
			<script src="assets/js/browser.min.js"></script>
			<script src="assets/js/breakpoints.min.js"></script>
			<script src="assets/js/util.js"></script>
			<script src="assets/js/main.js"></script>

	</body>
</html>
