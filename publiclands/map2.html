<!DOCTYPE HTML>
<!--
	Minimaxing by HTML5 UP
	html5up.net | @ajlkn
	Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html>
	<head>
		<title>Public Land Use Preferences</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
		<link rel="stylesheet" href="assets/css/main.css" />

		<!-- mapbox js -->
		<script src='https://api.tiles.mapbox.com/mapbox.js/v1.6.2/mapbox.js'></script>
		<link href='https://api.tiles.mapbox.com/mapbox.js/v1.6.2/mapbox.css' rel='stylesheet' />

	 <!-- leaflet draw library -->
	 <link rel='stylesheet' href='https://api.tiles.mapbox.com/mapbox.js/plugins/leaflet-draw/v0.2.2/leaflet.draw.css' />
	 <script src='https://api.tiles.mapbox.com/mapbox.js/plugins/leaflet-draw/v0.2.2/leaflet.draw.js'></script>

	 <!-- bootstrap for popup-->
	 <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
	 <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
	 <link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet"/>

	</head>

	<body>
		<div id="page-wrapper">

			<!-- Header -->
				<div id="header-wrapper">
					<div class="container">
						<div class="row">
							<div class="col-12">

								<header id="header">
									<h1>Land Use Preference Mapping</h1>
									<nav id="nav">
										<!-- <a href="index.html">Homepage</a>
										<a href="twocolumn1.html" class="current-page-item">Two Column #1</a>
										<a href="twocolumn2.html">Two Column #2</a>
										<a href="onecolumn.html">One Column</a>
										<a href="threecolumn.html">Three Column</a> -->
									</nav>
								</header>

							</div>
						</div>
					</div>
				</div>

			<!-- Main -->

			<div id="main">
				<div class="container">
					<div class="row main-row">
						<div class="col-12">

							<section>
								<h2>Instructions</h2>
								<p>The map below shows the Colville National Forest in Washington State. Click on either the line or polygon icons and draw shapes on the map to represent places where you prefer certain land use types. Once you draw a feature, click either the recreation, agriculture, or forestry button above the map to indicate which type of land use the polygon or line represents.</p>
							</section>

								<section>
									<h2>Map</h2>

									<!-- land use type buttons -->
									<button class="small" onclick="changeColor('purple')">Recreation - Yes</button>
									<button class="small" onclick="changeColor('dkpurple')">Recreation - No</button>
									<button class="small" onclick="changeColor('orange')">Agriculture - Yes</button>
									<button class="small" onclick="changeColor('dkorange')">Agriculture - No</button>
									<button class="small" onclick="changeColor('green')">Timber Harvest - Yes</button>
									<button class="small" onclick="changeColor('dkgreen')">Timber Harvest - No</button>
									<button class="small" onclick="changeColor('red')">Mining - Yes</button>
									<button class="small" onclick="changeColor('dkred')">Mining - No</button>
									<button class="small" onclick="changeColor('blue')">Conservation - Yes</button>
									<button class="small" onclick="changeColor('dkblue')">Conservation - No</button>

									<!-- add map div -->
									<div id='map' style='height: 75vh;'></div>

									<!-- convert attributes to geojson -->
									<button id="convert">
									Get all features to GeoJSON string
									</button>

									<div class="modal" id="attributes">
									  <div class="modal-dialog">
									    <div class="modal-content">
									      <div class="modal-header">
									        <h4 class="modal-title">Attribute Data</h4>
									      </div>
									      <div class="modal-body">

									<div  class="content-scroll5">

									<div class="col-xs-2">
									  <label for="ex1">ACTION</label>
									  <input class="form-control" name="action" id="actin" type="text">
									</div>
									      </div>
									      <div class="modal-footer">
									        <button type="button" class="btn btn-default" data-dismiss="modal">OK</button>
									      </div>
									    </div>
									  </div>
									</div>

										<!-- begin script -->
										<script>

										var map = L.map('map').setView([48.588, -117.870], 9);
											L.tileLayer('https://api.mapbox.com/styles/v1/emgew/cka5l6m1s17cr1imz0gwap4ey/tiles/256/{z}/{x}/{y}@2x?access_token=pk.eyJ1IjoiZW1nZXciLCJhIjoiY2sybzlheDB4MDJrdDNwbXp1OXVmN3dseCJ9.ukmQwSpvGDqj0hChY4ZUyQ', {
											    attribution: 'Map data &copy; <a href="https://www.openstreetmap.org/">OpenStreetMap</a> contributors, <a href="https://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, Imagery Â© <a href="https://www.mapbox.com/">Mapbox</a>',
											}).addTo(map);

											var editableLayers = L.geoJson().addTo(map);
											map.addControl(new L.Control.Draw({
												draw: {
											 		 polyline: false,
											 	 	 marker: false
											 	 },
													edit: {
											        featureGroup: editableLayers
											    }
											}));

											map.on('draw:created', function (e) {
											      var layer = e.layer,
											        feature = layer.feature = layer.feature || {};
											    feature.type = feature.type || "Feature";
											    var props = feature.properties = feature.properties || {};
											    //layer.feature = {properties: {}}; // No need to convert to GeoJSON.
											    //var props = layer.feature.properties;
											    props.action = null;

											    editableLayers.addLayer(layer);
											    addPopup(layer);
											});

											function addPopup(layer) {
											    var content = document.getElementById('action');
											    layer.feature.properties.action = content;

											/* content.addEventListener("keyup", function () {
											        layer.feature.properties.action = content;
											    });*/

											/*    layer.on("popupopen", function () {
											        content.value = layer.feature.properties.desc;
											      content.focus();
											    });
											    layer.bindPopup(content).openPopup();*/

											    layer.on('click', function() {
											        $('#action').val(layer.feature.properties.action);

											            //content.value = layer.feature.properties.action;
											            $('#attributes').modal({'show' : true, backdrop:'static', keyboard:false});
											           $('#action').val(layer.feature.properties.action);
											        });

											}

											document.getElementById("convert").addEventListener("click", function () {
											    console.log(JSON.stringify(editableLayers.toGeoJSON(), null, 2));
											});

											//Leaflet.draw
										// 	var drawnItems = L.featureGroup().addTo(map);
										// 	var drawControl = new L.Control.Draw({
										// 	 draw: {
										// 		 polyline: false,
 										// 	 	 marker: false
										// 	 },
										// 	 edit: {featureGroup: drawnItems}
										// 	}).addTo(map);
										//
										// 	map.on('draw:created', function (event) {
										//     var layer = event.layer,
										//         feature = layer.feature = layer.feature || {}; // Intialize layer.feature
										//
										//     feature.type = feature.type || "Feature"; // Intialize feature.type
										//     var props = feature.properties = feature.properties || {}; // Intialize feature.properties
										//     props.title = "my title";
										//     props.content = "my content";
										//     drawnItems.addLayer(layer);
										// });
										//
										// 	function saveIdIW() {
										// 	  var sName = $('#shapeName').val();
										// 	  var sDesc = $('#shapeDesc').val();
										// 	  var drawings = drawnItems.getLayers(); //drawnItems is a container for the drawn objects
										// 	  drawings[drawings.length - 1].title = sName;
										// 	  drawings[drawings.length - 1].content = sDesc;
										// 	  map.closePopup();
										// 	};
										//
										// 	//event function https://gis.stackexchange.com/questions/298655/updating-popup-of-a-leaflet-polygon
										// 	function onclick(e) {
										// 	  e.layer.bindPopup('A popup!');
										// 	}
										//
										// 	//bind listener to layers
										// 	drawnItems.on("click",onclick)

											//Export
											// document.getElementById('export').onclick = function(e) {
											//   // Extract GeoJson from featureGroup
											//   var data = drawnItems.toGeoJSON();
											//   // Stringify the GeoJson
											//   var convertedData = 'text/json;charset=utf-8,' + encodeURIComponent(JSON.stringify(data));
											//   // Create export
											//   document.getElementById('export').setAttribute('href', 'data:' + convertedData);
											//   document.getElementById('export').setAttribute('download', 'drawnItems.geojson');
											// }

										// //http://duspviz.mit.edu/web-map-workshop/cartodb-data-collection/
										// var drawnItems = new L.featureGroup();
										//
						        // var drawControl = new L.Control.Draw({
										// 		draw: {
										// 			polyline: false,
										// 			marker: false
										// 		},
										// 		edit: {
						        //         featureGroup: drawnItems
						        //     }
						        // }).addTo(map);
										//
										// // adds each feature drawn to group: https://bl.ocks.org/danswick/d30c44b081be31aea483
										// map.on('draw:created', function(e) {
										// 	var layer = e.layer;
										//   drawnItems.addLayer(layer);
										//   map.addLayer(drawnItems);
										//   dialog.dialog("open");
						        // });
										//
										// // Use the jQuery UI dialog to create a dialog and set options
										// var dialog = $("#dialog").dialog({
										//   autoOpen: false,
										//   height: 300,
										//   width: 350,
										//   modal: true,
										//   position: {
										//     my: "center center",
										//     at: "center center",
										//     of: "#map"
										//   },
										//   buttons: {
										//     "Add to Database": setData,
										//     Cancel: function() {
										//       dialog.dialog("close");
										//       map.removeLayer(drawnItems);
										//     }
										//   },
										//   close: function() {
										//     form[ 0 ].reset();
										//     console.log("Dialog closed");
										//   }
										// });
										//
										// // Stops default form submission and ensures that setData or the cancel function run
										// var form = dialog.find("form").on("submit", function(event) {
										//   event.preventDefault();
										// });

									// popup https://gis.stackexchange.com/questions/232585/changing-data-and-style-with-select-in-leaflet-popup
									// function onEachFeature(feature, layer) {
									//
									//   var select = document.createElement('select'),
									//     option0 = document.createElement('option'),
									//     option1 = document.createElement('option'),
									//     option2 = document.createElement('option');
									//
									//   select.addEventListener('change', function() {
									//     restyleLayer(this.value, this.layer);
									//   });
									//
									//   select.layer = layer;
									//
									//   option0.value = 'Nope';
									//   option0.selected = true;
									//   option0.innerHTML = 'None';
									//
									//   option1.value = 'Democrat';
									//   option1.innerHTML = 'Democrat';
									//
									//   option2.value = 'Republican';
									//   option2.innerHTML = 'Republican';
									//
									//   select.appendChild(option0);
									//   select.appendChild(option1);
									//   select.appendChild(option2);
									//
									//   layer.bindPopup(select);
									//
									// }
									//
									// var states_geojson = L.geoJSON(featureGroup, {
									//   style: function(feature) {
									//     return getColor(feature.properties.party)
									//   },
									//   onEachFeature: onEachFeature
									// }).addTo(map);
									//
									// function getColor(party) {
									//   console.log(party)
									//   switch (party) {
									//     case 'Republican':
									//       return {
									//         color: "red"
									//       };
									//     case 'Democrat':
									//       return {
									//         color: "blue"
									//       };
									//     case 'Nope':
									//       return {
									//         color: 'grey'
									//       };
									//   }
									// }
									//
									// function restyleLayer(party, layer) {
									//
									//   layer.feature.properties.party = party;
									//
									//   var myFillColor = getColor(party);
									//
									//   layer.setStyle(myFillColor);
									// }

									</script>
								</section>
							</div>

							<p>
							<a href="#" class="button">Submit</a>
							</p>

							</div>
						</div>
					</div>
				</div>

			<!-- Footer -->
				<div id="footer-wrapper">
					<div class="container">
						<div class="row">
							<div class="col-8 col-12-medium">

								<section>
									<h2>Data Sources</h2>
									<div>
										<div class="row">
											<div class="col-3 col-6-medium col-12-small">
												<ul class="link-list">
													<li><a href="https://data.fs.usda.gov/geodata/webapps/EDW_DataExtract/" target="_blank">USDA Forest Service</a></li>
													<li><a href="http://geo.wa.gov/datasets/wa-rco::wa-rco-trails-2017" target="_blank">WA State Recreation and Conservation Office</a></li>
												</ul>
											</div>

										</div>
									</div>
								</section>

							</div>

						</div>
						<div class="row">
							<div class="col-12">

								<div id="copyright">
									&copy; Untitled. All rights reserved. | Design: <a href="http://html5up.net">HTML5 UP</a>
								</div>

							</div>
						</div>
					</div>
				</div>

		</div>

		<!-- Scripts -->
			<script src="assets/js/jquery.min.js"></script>
			<script src="assets/js/browser.min.js"></script>
			<script src="assets/js/breakpoints.min.js"></script>
			<script src="assets/js/util.js"></script>
			<script src="assets/js/main.js"></script>

	</body>
</html>
