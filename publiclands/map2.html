<!DOCTYPE HTML>
<!--
	Minimaxing by HTML5 UP
	html5up.net | @ajlkn
	Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html>
	<head>
		<title>Public Land Use Preferences</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
		<link rel="stylesheet" href="assets/css/main.css" />

		<!-- leaflet libraries -->
		<link rel="stylesheet" href="https://unpkg.com/leaflet@1.6.0/dist/leaflet.css" />
		<script src="https://unpkg.com/leaflet@1.6.0/dist/leaflet.js"></script>

	 <!-- leaflet draw library -->
	 <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet.draw/1.0.4/leaflet.draw.css"/>

	</head>

	<body>
		<div id="page-wrapper">

			<script src="https://d19vzq90twjlae.cloudfront.net/leaflet-0.7/leaflet.js"></script>
	    <script src="https://cdnjs.cloudflare.com/ajax/libs/leaflet.draw/1.0.4/leaflet.draw.js"></script>

			<!-- Header -->
				<div id="header-wrapper">
					<div class="container">
						<div class="row">
							<div class="col-12">

								<header id="header">
									<h1>Land Use Preference Mapping</h1>
									<nav id="nav">
										<!-- <a href="index.html">Homepage</a>
										<a href="twocolumn1.html" class="current-page-item">Two Column #1</a>
										<a href="twocolumn2.html">Two Column #2</a>
										<a href="onecolumn.html">One Column</a>
										<a href="threecolumn.html">Three Column</a> -->
									</nav>
								</header>

							</div>
						</div>
					</div>
				</div>

			<!-- Main -->

			<div id="main">
				<div class="container">
					<div class="row main-row">
						<div class="col-12">

							<section>
								<h2>Instructions</h2>
								<p>The map below shows the Colville National Forest in Washington State. Click on either the line or polygon icons and draw shapes on the map to represent places where you prefer certain land use types. Once you draw a feature, click either the recreation, agriculture, or forestry button above the map to indicate which type of land use the polygon or line represents.</p>
							</section>

								<section>
									<h2>Map</h2>

									<!-- land use type buttons -->
									<button class="small" onclick="changeColor('purple')">Recreation - Yes</button>
									<button class="small" onclick="changeColor('dkpurple')">Recreation - No</button>
									<button class="small" onclick="changeColor('orange')">Agriculture - Yes</button>
									<button class="small" onclick="changeColor('dkorange')">Agriculture - No</button>
									<button class="small" onclick="changeColor('green')">Timber Harvest - Yes</button>
									<button class="small" onclick="changeColor('dkgreen')">Timber Harvest - No</button>
									<button class="small" onclick="changeColor('red')">Mining - Yes</button>
									<button class="small" onclick="changeColor('dkred')">Mining - No</button>
									<button class="small" onclick="changeColor('blue')">Conservation - Yes</button>
									<button class="small" onclick="changeColor('dkblue')">Conservation - No</button>

									<!-- add map div -->
									<div id='map' style='height: 75vh;'></div>

										<!-- begin script -->
										<script>

										var map = L.map('map').setView([48.588, -117.870], 9);
											L.tileLayer('https://api.mapbox.com/styles/v1/emgew/cka5l6m1s17cr1imz0gwap4ey/tiles/256/{z}/{x}/{y}@2x?access_token=pk.eyJ1IjoiZW1nZXciLCJhIjoiY2sybzlheDB4MDJrdDNwbXp1OXVmN3dseCJ9.ukmQwSpvGDqj0hChY4ZUyQ', {
											    attribution: 'Map data &copy; <a href="https://www.openstreetmap.org/">OpenStreetMap</a> contributors, <a href="https://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, Imagery Â© <a href="https://www.mapbox.com/">Mapbox</a>',
											}).addTo(map);

										//Leaflet.draw
										var drawFeatureID = '';

										var drawnItems = new L.FeatureGroup();
							      	map.addLayer(drawnItems);

							      var drawControl = new L.Control.Draw({
												draw: {
													polygon: true,
													circle: true,
													rectangle: true,
													circlemarker: false,
													marker: false,
													polyline: false
												},
												edit: {
							              featureGroup: drawnItems
							          }
							      });
							      map.addControl(drawControl);

										map.on('draw:created', function (e) {
											var type = e.layerType,
													layer = e.layer;
											drawnItems.addLayer(layer);
									});

									// allow editing
									function onEachFeature (feature, layer) {
										editableLayers.addLayer(layer);
										layer.on('click', function(e){
											if(selectedFeature)
												selectedFeature.editing.disable();
											selectedFeature = e.target;
											e.target.editing.enable();
										});
									}

									// popup https://gis.stackexchange.com/questions/232585/changing-data-and-style-with-select-in-leaflet-popup
									function onEachFeature(feature, layer) {

									  var select = document.createElement('select'),
									    option0 = document.createElement('option'),
									    option1 = document.createElement('option'),
									    option2 = document.createElement('option');

									  select.addEventListener('change', function() {
									    restyleLayer(this.value, this.layer);
									  });

									  select.layer = layer;

									  option0.value = 'Nope';
									  option0.selected = true;
									  option0.innerHTML = 'None';

									  option1.value = 'Democrat';
									  option1.innerHTML = 'Democrat';

									  option2.value = 'Republican';
									  option2.innerHTML = 'Republican';

									  select.appendChild(option0);
									  select.appendChild(option1);
									  select.appendChild(option2);

									  layer.bindPopup(select);

									}

									var states_geojson = L.geoJSON(drawnItems, {
									  style: function(feature) {
									    return getColor(feature.properties.party)
									  },
									  onEachFeature: onEachFeature
									}).addTo(map);

									function getColor(party) {
									  console.log(party)
									  switch (party) {
									    case 'Republican':
									      return {
									        color: "red"
									      };
									    case 'Democrat':
									      return {
									        color: "blue"
									      };
									    case 'Nope':
									      return {
									        color: 'grey'
									      };
									  }
									}

									function restyleLayer(party, layer) {

									  layer.feature.properties.party = party;

									  var myFillColor = getColor(party);

									  layer.setStyle(myFillColor);
									}


									// change shape colors
									// 		function changeColor(color) {
									// 				if (drawFeatureID !== '' && typeof draw === 'object') {
									// 						if (color === 'purple') {
									// 								draw.setFeatureProperty(drawFeatureID, 'portColor', '#cab2d6');
									// 						}
									// 							else if (color === 'dkpurple') {
									// 									draw.setFeatureProperty(drawFeatureID, 'portColor', '#6a3d9a');
									// 							} else if (color === 'orange') {
									// 									draw.setFeatureProperty(drawFeatureID, 'portColor', '#fdbf6f');
									// 							} else if (color === 'dkorange') {
									// 									draw.setFeatureProperty(drawFeatureID, 'portColor', '#ff7f00');
									// 							} else if (color === 'green') {
									// 									draw.setFeatureProperty(drawFeatureID, 'portColor', '#b2df8a')
									// 							} else if (color === 'dkgreen') {
									// 									draw.setFeatureProperty(drawFeatureID, 'portColor', '#33a02c');
									// 							} else if (color === 'red') {
									// 									draw.setFeatureProperty(drawFeatureID, 'portColor', '#fb9a99');
									// 							} else if (color === 'dkred') {
									// 									draw.setFeatureProperty(drawFeatureID, 'portColor', '#e31a1c');
									// 							} else if (color === 'blue') {
									// 									draw.setFeatureProperty(drawFeatureID, 'portColor', '#a6cee3');
									// 							} else if (color === 'dkblue') {
									// 									draw.setFeatureProperty(drawFeatureID, 'portColor', '#1f78b4');
									// 						}
									//
									// 						var feat = draw.get(drawFeatureID);
									// 						draw.add(feat)
									// 				}
									// 		}
									//
									// 		// callback for draw.update and draw.selectionchange
									// 		var setDrawFeature = function(e) {
									// 				if (e.features.length && e.features[0].type === 'Feature') {
									// 						var feat = e.features[0];
									// 						drawFeatureID = feat.id;
									// 				}
									// 		}
									//
									// 		// event handlers for draw tools
									// 		map.on('draw.create', function() {
									// 				newDrawFeature = true;
									// 		});
									//
									// 		map.on('draw.update', setDrawFeature);
									//
									// 		map.on('draw.selectionchange', setDrawFeature);
									//
									// 		map.on('click', function(e) {
									// 				if (!newDrawFeature) {
									// 						var drawFeatureAtPoint = draw.getFeatureIdsAt(e.point);
									//
									// 						//if another drawFeature is not found - reset drawFeatureID
									// 						drawFeatureID = drawFeatureAtPoint.length ? drawFeatureAtPoint[0] : '';
									// 				}
									//
									// 				newDrawFeature = false;
									//
									// 		});
									//
									// // add listeners
									// map.on('draw.create', updateArea);
									// map.on('draw.delete', updateArea);
									// map.on('draw.update', updateArea);
									//
									// // this function is called when a draw event is triggered (create, delete, update)
									// function updateArea(e) {
									// 		var data = draw.getAll();
									// 		console.log(data);
									// }

										// map.on('draw:created', function (event) {
										//     var layer = event.layer,
										//         feature = layer.feature = layer.feature || {}; // Intialize layer.feature
										//
										//     feature.type = feature.type || "Feature"; // Intialize feature.type
										//     var props = feature.properties = feature.properties || {}; // Intialize feature.properties
										//     props.title = "my title";
										//     props.content = "my content";
										//     drawnItems.addLayer(layer);
										// });
										//
										// function saveIdIW() {
										//   var sName = $('#shapeName').val();
										//   var sDesc = $('#shapeDesc').val();
										//   var drawings = drawnItems.getLayers(); //drawnItems is a container for the drawn objects
										//   drawings[drawings.length - 1].title = sName;
										//   drawings[drawings.length - 1].content = sDesc;
										//   map.closePopup();
										// };
										//
										// //Export
										// document.getElementById('export').onclick = function(e) {
										//   // Extract GeoJson from featureGroup
										//   var data = drawnItems.toGeoJSON();
										//   // Stringify the GeoJson
										//   var convertedData = 'text/json;charset=utf-8,' + encodeURIComponent(JSON.stringify(data));
										//   // Create export
										//   document.getElementById('export').setAttribute('href', 'data:' + convertedData);
										//   document.getElementById('export').setAttribute('download', 'drawnItems.geojson');
										// }

									</script>
								</section>
							</div>

							<p>
							<a href="#" class="button">Submit</a>
							</p>

							</div>
						</div>
					</div>
				</div>

			<!-- Footer -->
				<div id="footer-wrapper">
					<div class="container">
						<div class="row">
							<div class="col-8 col-12-medium">

								<section>
									<h2>Data Sources</h2>
									<div>
										<div class="row">
											<div class="col-3 col-6-medium col-12-small">
												<ul class="link-list">
													<li><a href="https://data.fs.usda.gov/geodata/webapps/EDW_DataExtract/" target="_blank">USDA Forest Service</a></li>
													<li><a href="http://geo.wa.gov/datasets/wa-rco::wa-rco-trails-2017" target="_blank">WA State Recreation and Conservation Office</a></li>
												</ul>
											</div>

										</div>
									</div>
								</section>

							</div>

						</div>
						<div class="row">
							<div class="col-12">

								<div id="copyright">
									&copy; Untitled. All rights reserved. | Design: <a href="http://html5up.net">HTML5 UP</a>
								</div>

							</div>
						</div>
					</div>
				</div>

		</div>

		<!-- Scripts -->
			<script src="assets/js/jquery.min.js"></script>
			<script src="assets/js/browser.min.js"></script>
			<script src="assets/js/breakpoints.min.js"></script>
			<script src="assets/js/util.js"></script>
			<script src="assets/js/main.js"></script>

	</body>
</html>
