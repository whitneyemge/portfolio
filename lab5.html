<!DOCTYPE html>
<!--
	Story by HTML5 UP
	html5up.net | @ajlkn
	Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
	Fullscreen plugin source: https://github.com/Leaflet/Leaflet.fullscreen
-->
<html>
	<head>
		<title>WA Public Lands</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0">
		<link rel="stylesheet" href="assets/css/main.css" />

		<!-- leaflet libraries -->
    <link rel="stylesheet" href="leaflet/leaflet.css"/>
		<script src="leaflet/leaflet.js"></script>
		<script src="assets/js/jquery-3.4.1.min.js"></script>
		<link rel="stylesheet" href="dist/leaflet.fullscreen.css"/>
		<script src="dist/Leaflet.fullscreen.js"></script>

		<!-- mapbox libraries -->
		<script src='https://api.mapbox.com/mapbox-gl-js/v0.44.1/mapbox-gl.js'></script>
			<link href='https://api.mapbox.com/mapbox-gl-js/v0.44.1/mapbox-gl.css' rel='stylesheet' />
		<script src='https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-draw/v1.0.0/mapbox-gl-draw.js'></script>
			<link rel='stylesheet' href='https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-draw/v1.0.0/mapbox-gl-draw.css' type='text/css'/>

	</head>
	<body>

	<!-- Title and info -->
		<section class="wrapper style1 align-center">
			<div class="inner">
				<h2>HEADER</h2>
				<p>This map shows...</p>

	<!-- Leaflet map -->

    <div id="mapid" style='height: 75vh;'></div>

      <script>
        var mymap = L.map('mapid', {fullscreenControl: {pseudoFullscreen: false}}).setView([47.598194, -120.683628], 7);
				L.tileLayer('https://api.tiles.mapbox.com/v4/{id}/{z}/{x}/{y}.png?access_token={accessToken}', {
          attribution: 'Map data &copy; <a href="https://www.openstreetmap.org/">OpenStreetMap</a> contributors, <a href="https://creativecommons.org/licenses/by-sa/2.0/">CC-BY-SA</a>, Imagery Â© <a href="https://www.mapbox.com/">Mapbox</a>',
          maxZoom: 18,
          id: 'mapbox.outdoors',
          accessToken: 'pk.eyJ1IjoiZW1nZXciLCJhIjoiY2sybzlheDB4MDJrdDNwbXp1OXVmN3dseCJ9.ukmQwSpvGDqj0hChY4ZUyQ'
				}).addTo(mymap);

				//Add polygon data
				var landowner = null;

				$.getJSON("assets/geojson/MPL.geojson",function(data){
					landowner = L.geoJson (data);
					geojson = L.geoJson(data,{
									style: function(feature){
										var polyColor,
											owner = feature.properties.OWNER;
												if (owner === "City or Municipal Government") polyColor = "#F1800F";
												else if (owner === "Federal Government") polyColor = "#2980b9";
												else if (owner === "State Government") polyColor = "#8E0FF1";
												else if (owner === "County Government") polyColor = "#F10F46";
											return {color: "#ffffff", weight: 0.3, fillColor: polyColor, fillOpacity: 0.7};
									},
									onEachFeature: function (feature, layer) {
										layer.bindPopup("Owner: " + feature.properties.OWNER + "<br>Manager: " + feature.properties.MANAGER + "<br>Management Type: " + feature.properties.MANAGEMENT_TYPE);
										layer.on({
											mouseover: highlightFeature,
											mouseout: resetHighlight
										})
									}
				 				}).addTo(mymap);

									//Add feature highlight
									function highlightFeature(e) {
									    var layer = e.target;

												layer.setStyle({
									        weight: 0.4,
									        color: '#ffffff',
									        dashArray: '',
									        fillOpacity: 0.6
									    	});

									    if (!L.Browser.ie && !L.Browser.opera && !L.Browser.edge) {
									        layer.bringToFront();
									    }
											info.update(layer.feature.properties);
										}

										var geojson;

									function resetHighlight(e) {
    								geojson.resetStyle(e.target);
										info.update();
									}
								});

      </script>
		</div>
	</section>
<br>
<section class="wrapper style1 align-center">
	<div class="inner">
		<p>This map shows...</p>
</div>
</section>

		<div id='vgimap' style='height: 75vh;'></div>

		<script>

		mapboxgl.accessToken = 'pk.eyJ1IjoiZW1nZXciLCJhIjoiY2sybzlheDB4MDJrdDNwbXp1OXVmN3dseCJ9.ukmQwSpvGDqj0hChY4ZUyQ';

		var map = new mapboxgl.Map({
		  container: 'vgimap',
		  style: 'mapbox://styles/mapbox/streets-v8',
		  center: [-120.683628, 47.598194,],
		  zoom: 9
		});

		//Add draw controls
	var draw = new MapboxDraw({
		 displayControlsDefault: false,
		 controls: {
				 polygon: true,
				 trash: true
		 }
	});

	map.addControl(draw);

	//Add listeners
	map.on('draw.create', updateArea);
	map.on('draw.delete', updateArea);
	map.on('draw.update', updateArea);

	//This function is called when a draw event is triggered (create, delete, update)
	//API ref for all that you can do with the draw control: https://github.com/mapbox/mapbox-gl-draw/blob/master/docs/API.md
	function updateArea(e) {
			var data = draw.getAll();
			//We are simply logging all the geometries into console
			//Your first shape's points data can be found in features->0->geometry->coordinates
			console.log(data);
			//You can use http://turfjs.org/ to get bounding boxes, area, etc for these shapes
	}

	</script>

<!-- Sources -->
				<section class="wrapper style1 align-center">
					<div class="inner">
						<h3>Data Sources</h3>
						<p><a href="http://geo.wa.gov/datasets/wadnr::wa-major-public-lands-non-dnr/data?geometry=-122.736%2C46.972%2C-118.828%2C47.624&orderBy=OWNER&orderByAsc=false" target="_blank">WA Major Public Lands (non-DNR)</a>
						<br><a href="" target="_blank">SOURCE</a></p>
					</div>
				</section>

<!-- Home Button -->
				<footer class="wrapper style1 align-center">
					<div class="inner">
						<ul class="actions stacked">
							<li><a href="https://whitneyemge.github.io/portfolio/" class="button">Back to Home</a></li>
						</ul>
					</div>
				</footer>

    </body>
  </html>
